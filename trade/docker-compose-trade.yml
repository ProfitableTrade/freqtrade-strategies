version: "3.8"
services:
  freqtrade:
    image: freqtradeorg/freqtrade:stable
    container_name: ${TRADE_NAME}-freqtrade
    volumes:
      - "./user_data:/freqtrade/user_data:rw"
      # - "./user_data/logs:/freqtrade/user_data/logs:rw"
    env_file:
      - ./trade.env
    command: >
      trade
      --strategy ${STRATEGY}
      --config /freqtrade/user_data/${CONFIG_NAME}.json
      --logfile /freqtrade/user_data/logs/freqtrade.log
      --db-url sqlite:////freqtrade/user_data/tradesv3.sqlite
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.${TRADE_NAME}-freqtrade.rule=Host(`${TRADE_NAME}.${DOMAIN:?portainer_domain_error}`)"
      - "traefik.http.routers.${TRADE_NAME}-freqtrade.entrypoints=https"
      - "traefik.http.routers.${TRADE_NAME}-freqtrade.tls.certresolver=letsEncrypt"
      - "traefik.http.services.${TRADE_NAME}-freqtrade.loadbalancer.server.port=8080"
#----------------------------------------
# Networks
#----------------------------------------
networks:
  default:
    driver: bridge
    external: true
    name: trade